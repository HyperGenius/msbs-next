# Project Roadmap: MSBS-Next (仮)

ブラウザベースの定期更新型MSバトルシミュレーションゲームの開発ロードマップです。
MSBSのプレイ感を現代的なクラウドネイティブ技術で再現・進化させることを目的とします。

## 1. プロジェクト概要

* **ジャンル:** 定期更新型タクティカルバトルシミュレーション (PvPvE)
* **プラットフォーム:** Webブラウザ (PC/Mobile)
* **コア体験:** MSカスタマイズ → 戦術設定 → 自動シミュレーション → バトルログ確認

## 2. 技術スタック

* **Frontend:** Next.js (App Router), Vercel
* **Backend:** Python (FastAPI), Pydantic, Render
* **Simulation:** NumPy (ベクトル計算), Pure Python Logic
* **Database:** Supabase (PostgreSQL)
* **Visuals:** React Three Fiber (Phase 2以降)

## 3. 開発フェーズ

### Phase 0: プロトタイプ (Simulation Engine Core)
**ゴール:** CLI上で2機のMSが3D空間を移動し、射程に入ったらログを出す。

* **実装機能:**
    * [ ] **データ構造定義 (Pydantic):** MS、座標(Vector3)、武器、戦術設定の型定義。
    * [ ] **3D空間ロジック (NumPy):**
        * X-Y-Z座標系の定義 (例: 10km^3 の宇宙空間)。
        * 移動ベクトルの計算 (現在地からターゲットへの接近)。
        * 距離計測と索敵判定。
    * [ ] **ターン処理:** 1ターンごとの状態更新ループの実装。
    * [ ] **テキストログ出力:** 行動結果を標準出力またはJSONファイルに書き出し。

### Phase 1: MVP (Minimum Viable Product)
**ゴール:** Webブラウザ上で「機体設定→戦闘開始→結果ログ閲覧」のコアサイクルが回る。

* **Frontend (Next.js):**
    * [ ] ユーザー登録・ログイン (Supabase Auth)。
    * [ ] ガレージ画面 (ステータス確認、簡易装備変更)。
    * [ ] バトルエントリー画面 (対戦相手はランダム or ID指定)。
    * [ ] 結果表示画面 (テキスト形式のバトルログ表示)。
* **Backend (FastAPI):**
    * [ ] バトル実行APIエンドポイントの実装。
    * [ ] バトル結果のDB保存 (JSONBカラム活用)。
* **Game Logic:**
    * [ ] 簡易戦闘の実装 (命中率計算、ダメージ計算、HP減少)。
    * [ ] 勝敗判定。

### Phase 2: α版 (Visual & Strategy Update)
**ゴール:** 視覚的な面白さと戦術性の向上。

* **Visuals:**
    * [ ] **3Dリプレイ (Three.js/R3F):** バトルログJSONを解析し、ブラウザ上で簡易的な3Dモデル(箱等)を動かして戦闘を再現する。
* **Logic:**
    * [ ] **AI/戦術設定:** 「HP50%以下で回避優先」「遠距離重視」などの行動パターンの実装。
    * [ ] **成長要素:** 戦闘後の経験値獲得とパイロットステータス上昇。

### Phase 3: β版 (Community & Expansion)
**ゴール:** 定期更新ゲームとしての体裁を整える。

* **System:**
    * [ ] **定期更新自動化:** 指定時間に対戦キューを一括処理するバッチ処理 (GitHub Actions / Render Cron)。
    * [ ] **ランキング:** 勝敗数や撃墜数によるランキング集計。
* **Content:**
    * [ ] 勢力 (Faction) の導入。
    * [ ] MS/武器のバリエーション追加。

### Phase 4: 正式サービス (Monetization)
**ゴール:** 収益化と運営体制の確立。

* **Economy:**
    * [ ] Stripe決済導入。
    * [ ] アバター/スキン等のコスメティックアイテム販売。
* **Ops:**
    * [ ] 運営管理画面の整備。

---

## 4. シミュレーション仕様 (Phase 0〜1)

物理エンジンは使用せず、数学的な計算のみで処理する。

* **フィールド:**
    * 境界ありの3D空間。
    * 障害物は「座標と半径を持つ球」として定義（Phase 0では無し）。
* **移動:**
    * 慣性は考慮せず、毎ターン `速度` パラメータ分だけベクトル移動する単純モデルを採用。
* **判定:**
    * **索敵:** `Distance(A, B) <= SensorRange`
    * **攻撃:** 射程内かつ射線(Line of Fire)が通る場合に確率で命中。

## 5. データモデル設計案 (Database)

* `users`: ユーザー基本情報
* `pilots`: パイロットステータス (メイン/サブ)
* `mobile_suits`: 所持機体データ (Customized JSON)
* `battle_logs`: 戦闘結果 (JSONB - リプレイデータ含む)
* `factions`: 勢力情報