# 次のステップ: 開発優先度ガイド

**作成日**: 2026年2月9日  
**最終更新**: 2026年2月24日  
**現在のフェーズ**: Phase 3 (β版 - Community & Content) 進行中

Phase 2.6（UI/UX強化）まで完了し、Phase 3ではランキングシステム、エースパイロット、NPC性格システムの実装が完了しています。
本ドキュメントは、次に取り組むべき項目を優先度順にまとめたガイドです。

---

## 📊 現在の状況

### ✅ 完了している主要機能
- ✅ Phase 0: Simulation Engine Core
- ✅ Phase 1: MVP (基本的なゲームサイクル)
- ✅ Phase 2: α版 (定期更新型 PvPvE)
- ✅ Phase 2.5: シミュレーションエンジンの高度化
  - 武器属性と相性システム
  - 地形適正と索敵（Fog of War）
  - 戦略AI
  - リソース管理（弾薬、EN、クールダウン）
- ✅ Phase 2.6: UI/UX強化
  - フロントエンドのPhase 2.5対応（地形適正、リソース、武器詳細のUI反映）
  - 3Dバトルビューア大幅強化（環境別演出、索敵範囲可視化、ダメージフラッシュ）
  - ダッシュボードUI刷新（カウントダウンタイマー、エントリー管理、結果モーダル）
  - SciFiデザインシステム導入
- ✅ Phase 3 一部完了:
  - ランキングシステム（シーズン制、Top 100、バッチ自動更新）
  - プレイヤー視察機能（機体・装備・戦術の閲覧）
  - エースパイロット（5体のネームドNPC、レア出現、特別報酬）
  - NPC性格システム（AGGRESSIVE/CAUTIOUS/SNIPER、戦闘セリフ）

### 🔧 残課題
- NPC永続化と自律成長が未実装
- 個人戦績・バトル統計が未実装
- デプロイ環境が未構築
- E2Eテストが未整備
- 勢力システム・コンテンツ拡充が未着手

---

## 🎯 Phase 3 残タスクの優先順位

### 優先度 🔴 高 - コア機能の完成

#### 1. NPC永続化と自律成長
**目的**: NPCに個性を持たせ、「あの時のザク」との再戦を可能にし、NPCがバトルを通じて成長するシステムを構築する。

**作業時間**: 3-4日

**実装内容**:
- NPC用のPilot/MobileSuitレコードの永続化（現在はマッチング時に毎回生成）
- 個体識別（NPCプロフィールと戦績管理）
- NPC再登場システム（前回バトルのNPCが再出現）
- バトル後のNPC経験値獲得とレベルアップ
- 獲得報酬による機体強化AIロジック

**ファイル**:
- `backend/app/models/models.py` - Pilotモデルに `is_npc` フィールド追加
- `backend/app/services/npc_service.py` (新規)
- `backend/app/services/matching_service.py` - 既存NPC再登場ロジック

---

#### 2. 個人戦績 & バトル統計
**目的**: プレイヤーに自身の成長と戦績を可視化し、戦略改善のヒントを提供する。

**作業時間**: 2-3日

**実装内容**:
- 個人戦績ページ（参加履歴、平均順位、K/D比、勝率推移）
- バトル統計ダッシュボード（武器使用率、地形別勝率、戦術効果分析）
- API: `GET /api/pilots/me/stats`

---

#### 3. デプロイ環境の構築
**目的**: ローカル環境からクラウド環境へ移行し、外部アクセス可能にする。

**作業時間**: 3-5日

**実装内容**:
- Frontend: Vercel デプロイ
- Backend: Render.com または Railway デプロイ
- CI/CDパイプラインの整備（GitHub Actions）
- 環境変数管理
- バッチスケジュール（cron）の有効化

---

### 優先度 🟡 中 - システムの安定性と品質向上

#### 4. テストカバレッジの拡充
**目的**: 実装済み機能の品質保証と、リグレッションの防止。

**作業時間**: 2-3日

**実装内容**:
- Phase 2.5機能の統合テスト（地形適正、リソース管理、武器属性の境界値テスト）
- E2Eテスト（Playwright）の導入
- CI/CDパイプラインへのテスト組み込み

---

#### 5. 勢力システム (Faction)
**目的**: 所属勢力ごとのボーナス・専用機体で戦略の幅を広げる。

**作業時間**: 3-4日

**実装内容**:
- 勢力テーブルの作成（地球連邦 / ジオン / その他）
- 勢力ボーナスシステム
- 勢力ミッション、勢力ランキング

---

### 優先度 🟢 中低 - コンテンツ拡充

#### 6. MS/武器バリエーション
**目的**: より多様な機体と武器の選択肢を提供。

**作業時間**: 3-5日

**実装内容**:
- 機体・武器のアンロック/購入システム拡充
- レア度システム (Common/Rare/Epic/Legendary)
- 機体ツリー（開発系統）
- 武器換装システム

---

#### 7. ソーシャル機能
**目的**: プレイヤー間の交流を促進する。

**作業時間**: 5-7日

**実装内容**:
- フレンド機能（フォロー、対戦履歴閲覧）
- プライベートマッチ
- チーム戦（2〜3人チームでのバトルロイヤル）
- ギルド/クラン

---

### 優先度 🔵 低 - 継続的改善

#### 8. リファクタリング
- BattleSimulatorクラスの分割（500行超）
- フロントエンドコンポーネントの細分化
- カスタムフックの整理

#### 9. パフォーマンス最適化
- DBクエリの最適化（N+1問題、インデックス追加）
- フロントエンドバンドルサイズの削減
- 3Dレンダリングの最適化（LOD、インスタンシング）

---

## 📝 実装の優先順位まとめ

| 優先度 | 項目 | 作業時間 | 効果 |
|--------|------|----------|------|
| 🔴 高 | NPC永続化と自律成長 | 3-4日 | 世界観の深化 |
| 🔴 高 | 個人戦績 & バトル統計 | 2-3日 | ユーザー体験向上 |
| 🔴 高 | デプロイ環境の構築 | 3-5日 | 外部公開可能 |
| 🟡 中 | テストカバレッジの拡充 | 2-3日 | 品質保証 |
| 🟡 中 | 勢力システム | 3-4日 | 戦略の多様化 |
| 🟢 中低 | MS/武器バリエーション | 3-5日 | コンテンツ充実 |
| 🟢 中低 | ソーシャル機能 | 5-7日 | コミュニティ構築 |
| 🔵 低 | リファクタリング | 継続的 | 保守性向上 |
| 🔵 低 | パフォーマンス最適化 | 継続的 | UX向上 |

---

## ✅ 完了済みタスク（参考）

以下のタスクは以前のNEXT_STEPSに記載されていましたが、すでに実装完了しています。

| 項目 | 完了日 | レポート |
|------|--------|---------|
| フロントエンドのPhase 2.5対応 | 2026-02-09 | [Phase 2.5 UI実装](reports/PHASE_2_5_COMPLETION_REPORT.md) |
| バトルビューア大幅強化 | 2026-02-11 | [バトルビューア強化](reports/IMPLEMENTATION_SUMMARY_BATTLE_VIEWER.md) |
| ダッシュボードUI刷新 | 2026-02-11 | [ダッシュボード改善](reports/DASHBOARD_IMPLEMENTATION_REPORT.md) |
| ランキングシステム | 2026-02-14 | [ランキング実装](reports/RANKING_IMPLEMENTATION_SUMMARY.md) |
| プレイヤー視察機能 | 2026-02-14 | [ランキング実装](reports/RANKING_IMPLEMENTATION_SUMMARY.md) |
| エースパイロット (ネームドNPC) | 2026-02-14 | [エースパイロット](reports/ACE_PILOT_IMPLEMENTATION_SUMMARY.md) |
| NPC性格システム & 戦闘セリフ | 2026-02-14 | [エースパイロット](reports/ACE_PILOT_IMPLEMENTATION_SUMMARY.md) |

---

## 📚 関連ドキュメント

- [Project Roadmap](roadmaps/roadmap.md) - プロジェクト全体のロードマップ
- [Battle Simulation Roadmap](roadmaps/battle_simulation_roadmap.md) - シミュレーションエンジンの仕様
- [実装レポート](reports/) - 各機能の実装詳細

---

**Last Updated**: 2026年2月24日
