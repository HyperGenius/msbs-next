# Battle Simulation Logic Expansion Roadmap

本ドキュメントは、MSBS-Next のシミュレーションエンジン（戦闘ロジック）の拡張計画をまとめたものです。
シンプルな「数値の殴り合い」から、戦略的かつ自律的な戦闘シミュレーションへの進化を目指します。

## 1. 段階的実装プラン (Recommended Roadmap)

### Step 1: 基本属性と相性の実装 (Attributes & Compatibility)
**目的:** 機体・武器選択の重要性を高め、単純なスペック勝ちを防ぐ。
**対応 Issue:** Issue 12

* **武器属性 (Weapon Attributes)**
    * 区分: `BEAM` (ビーム) / `PHYSICAL` (実弾)
    * 機体耐性: `beam_resistance` / `physical_resistance` (ダメージ軽減率)
* **距離適正 (Optimal Range)**
    * パラメータ: `optimal_range` (最適射程), `decay_rate` (減衰係数)
    * ロジック: 最適射程からの偏差に応じて命中率が低下する（放物線/正規分布）。

### Step 2: バトルフィールドと索敵 (Field & Detection)
**目的:** 「場所」と「情報の非対称性」を導入し、移動や索敵特化機体の役割を作る。

* **バトルフィールド属性**
    * 環境: `Space` (宇宙), `Ground` (地上), `Colony` (コロニー内) など。
    * 適正補正: 機体の地形適正により、移動速度や回避率にボーナス/ペナルティ。
* **索敵ロジック (Fog of War)**
    * 現状の「全機体が常に見えている」状態を廃止。
    * `sensor_range` 内の敵のみを「索敵済みリスト」に追加し、ターゲット候補とする。
* **環境効果**
    * ミノフスキー粒子濃度: 索敵範囲や命中率への全体デバフ係数。

### Step 3: 簡易版・戦略AI (Rule-based AI)
**目的:** AIが「倒すべき敵」と「避けるべき敵」を区別して自律行動できるようにする。

* **戦略価値 (Strategic Value)**
    * 算出式案: `(HP + 攻撃力) * Cost`
    * 意味: 敵にとって「倒すと価値が高い（スコアになる）」目標。
* **脅威度 (Threat Assessment)**
    * 算出式案: `(相手の攻撃力 / 自機の残りHP) / 距離`
    * 意味: 自機にとって「放置すると危険」な目標。
* **ターゲット選択ロジック**
    * Tactics設定に基づき、「脅威度最大」または「戦略価値最大」の敵を狙う。

### Step 4: リソース管理 (Resource Management)
**目的:** 戦闘の長期化を防ぎ、「継戦能力」というパラメータを作る。

* **弾数制限 (Ammo)**
    * 武器に `current_ammo` / `max_ammo` を追加。0になると使用不可（または格闘のみ）。
* **クールタイム (Cool-down)**
    * 強力な武器発射後の「待機ターン」の実装。
* **EN/ジェネレーター**
    * ビーム兵器使用時のEN消費管理。

---

## 2. 将来的な高度機能 (Advanced Features)

以下の機能は実装コストが高く、バランス調整が困難なため、**α版リリース後 (Phase 3以降)** の検討事項とする。

* **高度な移動制御 (Potential Fields)**
    * 引力（ターゲット）と斥力（障害物・脅威）のベクトル合成による移動経路生成。
* **ファジィ推論AI (Fuzzy Logic)**
    * 「HPが低い」かつ「敵が近い」→「逃走」のような、曖昧な状況判断ロジック。
* **複雑な障害物 (Complex Obstacles)**
    * 遮蔽物による射線切れ、衝突判定、回避ルーティング。
* **完全リアルタイム化 (Tick-based)**
    * ターン制から、秒間60フレーム等の物理シミュレーションへの移行（サーバー負荷を考慮し慎重に検討）。
* **天候変動**
    * 雨、雪、砂嵐などによる動的なステータス変化。
